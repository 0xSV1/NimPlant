"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[256],{4850:function(e,n,t){t.d(n,{Z:function(){return O}});var o=t(5893),r=t(7564),l=t(1232),i=t(3723),c=t(5606),a=t(7841),s=t(4998),u=t(5154),d=t(4065),h=t(5909),p=t(4707),x=t(3485),g=t(5117),f=t(8818),m=t(9814),j=t(8054),v=t(4151),y=t(9876),C=t(8602),S=t(7294),w=function(e){let{modalOpen:n,setModalOpen:t,npGuid:r}=e,[l,i]=(0,S.useState)(null),[c,d]=(0,S.useState)(""),[h,p]=(0,S.useState)(!0),[w,E]=(0,S.useState)(!0),[T,b]=(0,S.useState)(!1),I=()=>{l&&null!==l&&(b(!0),(0,s.cT)(l,k,P))},k=e=>{(0,s.QL)(String(r),"execute-assembly BYPASSAMSI=".concat(h?1:0," BLOCKETW=").concat(w?1:0,' "').concat(e,'" ').concat(c),P)},P=()=>{t(!1),i(null),d(""),p(!0),E(!0),b(!1)};return(0,o.jsxs)(x.u,{opened:n,onClose:()=>t(!1),title:(0,o.jsx)("b",{children:"Execute-Assembly: Execute .NET program"}),size:"auto",centered:!0,children:[(0,o.jsx)(g.x,{children:"Execute a .NET (C#) program in-memory."}),(0,o.jsx)(g.x,{children:"Caution: Running execute-assembly will load the CLR!"}),(0,o.jsx)(f.T,{h:"xl"}),(0,o.jsxs)(m.M,{cols:1,children:[(0,o.jsx)(j.S,{onChange:i,children:e=>(0,o.jsx)(a.z,{color:"gray",...e,children:l?"File: "+l.name:"Select .NET binary"})}),(0,o.jsx)(v.I,{placeholder:"Arguments",value:c,onChange:e=>d(e.currentTarget.value)}),(0,o.jsxs)(y.k,{gap:"xl",justify:"center",align:"center",children:[(0,o.jsx)(C.A,{checked:h,onChange:p,children:"Patch AMSI"}),(0,o.jsx)(C.A,{checked:w,onChange:E,children:"Block ETW"})]})]}),(0,o.jsx)(f.T,{h:"xl"}),(0,o.jsx)(a.z,{onClick:I,leftIcon:(0,o.jsx)(u.fF,{}),sx:{width:"100%"},loading:T,children:"Execute"})]})},E=t(50),T=t(292),b=t(4201),I=function(e){let{modalOpen:n,setModalOpen:t,npGuid:i}=e,[c,d]=(0,S.useState)(null),[h,p]=(0,S.useState)("go"),[m,y]=(0,S.useState)([]),[C,w]=(0,S.useState)(!1),I=()=>{y([...m,{value:"",type:"z"}])},k=(e,n,t)=>{y(m.map((o,r)=>r===e?{value:n,type:t}:o))},P=e=>{y(m.filter((n,t)=>t!==e))},F=()=>{c&&null!==c&&(w(!0),(0,s.cT)(c,O,Z))},O=e=>{let n=m.map(e=>'"'.concat(e.value,'" ').concat(e.type)).join(" ");(0,s.QL)(String(i),'inline-execute "'.concat(e,'" "').concat(h,'" ').concat(n),Z)},Z=()=>{t(!1),d(null),p("go"),y([]),w(!1)};return(0,o.jsxs)(x.u,{opened:n,onClose:()=>t(!1),title:(0,o.jsx)("b",{children:"Inline-Execute: Execute BOF file"}),size:"auto",centered:!0,children:[(0,o.jsx)(g.x,{children:"Execute a Beacon Object File (BOF) in-memory."}),(0,o.jsx)(g.x,{children:"Caution: BOF crashes will crash NimPlant too!"}),(0,o.jsx)(f.T,{h:"xl"}),(0,o.jsxs)(E.r,{columns:4,children:[(0,o.jsx)(E.r.Col,{span:3,children:(0,o.jsx)(l.Z,{grow:!0,children:(0,o.jsx)(j.S,{onChange:d,children:e=>(0,o.jsx)(a.z,{color:"gray",...e,children:c?"BOF file: "+c.name:"Select x64 BOF file"})})})}),(0,o.jsx)(E.r.Col,{span:1,children:(0,o.jsx)(v.I,{placeholder:"Entrypoint",value:h,onChange:e=>p(e.currentTarget.value)})})]}),(0,o.jsx)(r.K,{py:m.length>0?"lg":"sm",children:m.map((e,n)=>(0,o.jsxs)(E.r,{columns:12,children:[(0,o.jsx)(E.r.Col,{span:8,children:(0,o.jsx)(v.I,{placeholder:"Argument ".concat(n+1),value:e.value,onChange:t=>k(n,t.currentTarget.value,e.type)})}),(0,o.jsx)(E.r.Col,{span:3,children:(0,o.jsx)(T.p,{placeholder:"Argument type",value:e.type,onChange:t=>k(n,e.value,t.currentTarget.value),data:[{label:"String",value:"z"},{label:"Wide String",value:"Z"},{label:"Integer",value:"i"},{label:"Short",value:"s"},{label:"Binary (b64)",value:"b"}]})}),(0,o.jsx)(E.r.Col,{span:1,children:(0,o.jsx)(b.P,{size:"lg",onClick:()=>P(n)})})]},n))}),(0,o.jsx)(l.Z,{grow:!0,children:(0,o.jsx)(a.z,{color:"gray",onClick:I,children:"Add argument"})}),(0,o.jsx)(f.T,{h:"xl"}),(0,o.jsx)(a.z,{onClick:F,leftIcon:(0,o.jsx)(u.fF,{}),loading:C,sx:{width:"100%"},children:"Execute"})]})},k=t(4882),P=function(e){let{modalOpen:n,setModalOpen:t,npGuid:r}=e,[l,i]=(0,S.useState)(null),[c,d]=(0,S.useState)(void 0),[h,p]=(0,S.useState)(!1),v=()=>{l&&null!==l&&(p(!0),(0,s.cT)(l,y,C))},y=e=>{(0,s.QL)(String(r),"shinject ".concat(c,' "').concat(e,'"'),C)},C=()=>{t(!1),i(null),d(void 0),p(!1)};return(0,o.jsxs)(x.u,{opened:n,onClose:()=>t(!1),title:(0,o.jsx)("b",{children:"Shinject: Inject and execute shellcode"}),size:"auto",centered:!0,children:[(0,o.jsx)(g.x,{children:"Execute shellcode in a selected target process using dynamic invocation."}),(0,o.jsx)(f.T,{h:"xl"}),(0,o.jsxs)(m.M,{cols:1,children:[(0,o.jsx)(j.S,{onChange:i,children:e=>(0,o.jsx)(a.z,{color:"gray",...e,children:l?"File: "+l.name:"Select shellcode file"})}),(0,o.jsx)(k.Y,{placeholder:"Target Process (PID)",value:c,icon:(0,o.jsx)(u.ULU,{}),onChange:e=>d(e),min:0,precision:0})]}),(0,o.jsx)(f.T,{h:"xl"}),(0,o.jsx)(a.z,{onClick:v,leftIcon:(0,o.jsx)(u.fF,{}),sx:{width:"100%"},loading:h,children:"Execute"})]})},F=function(e){let{modalOpen:n,setModalOpen:t,npGuid:r}=e,[l,i]=(0,S.useState)(null),[c,d]=(0,S.useState)(""),[h,p]=(0,S.useState)(!1),y=()=>{l&&null!==l&&(p(!0),(0,s.cT)(l,C,w))},C=e=>{(0,s.QL)(String(r),'upload "'.concat(e,'" "').concat(c,'"'),w)},w=()=>{t(!1),i(null),d(""),p(!1)};return(0,o.jsxs)(x.u,{opened:n,onClose:()=>t(!1),title:(0,o.jsx)("b",{children:"Upload: Upload a file"}),size:"auto",centered:!0,children:[(0,o.jsx)(g.x,{children:"Upload a file to the target."}),(0,o.jsx)(f.T,{h:"xl"}),(0,o.jsxs)(m.M,{cols:1,children:[(0,o.jsx)(j.S,{onChange:i,children:e=>(0,o.jsx)(a.z,{color:"gray",...e,children:l?"File: "+l.name:"Select file"})}),(0,o.jsx)(v.I,{placeholder:"Destination Path (optional)",value:c,onChange:e=>d(e.currentTarget.value)})]}),(0,o.jsx)(f.T,{h:"xl"}),(0,o.jsx)(a.z,{onClick:y,leftIcon:(0,o.jsx)(u.DUB,{}),sx:{width:"100%"},loading:h,children:"Upload"})]})},O=function(e){let{allowInput:n,consoleData:t,disabled:x,guid:g,inputFunction:f}=e,m=(0,d.a)("(min-width: 800px)"),j=(0,S.useRef)(),[v,y]=(0,S.useState)(!0),C=(0,h.P)(),[E,T]=(0,S.useState)([]),[b,k]=(0,S.useState)(!1),[O,Z]=(0,S.useState)(""),[B,z]=(0,S.useState)(0),[L,M]=(0,S.useState)(!1),[A,H]=(0,S.useState)(!1),[D,N]=(0,S.useState)(!1),[K,U]=(0,S.useState)(!1),{commandList:G,commandListLoading:R,commandListError:Q}=(0,s.IZ)(),W=()=>{if(""===O)return[];var e=[];return R||Q||(e=G.map(e=>e.command)),Object.keys(t).forEach(n=>{if(null!==t[n].taskFriendly){var o=t[n].taskFriendly;e.includes(o)||e.push(o)}}),e.filter(e=>e.startsWith(O)&&e!=O)},X=()=>{if(void 0!==f&&void 0!==g){if(0===E.length)k(!1);else if(b)return;"execute-assembly"===O?M(!0):"inline-execute"===O?H(!0):"shinject"===O?N(!0):"upload"===O?U(!0):f(g,O),z(0),Z("")}},_=e=>{let n=t.filter(e=>null!==e.taskFriendly),o=n.length;var r=B+e;if(0!==o&&(n.some(e=>e.taskFriendly==O)||""===O)&&(0!==B||1!==e)){if(0===B&&-1===e&&(r=o),r<1)r=1;else if(r>o){z(0),Z("");return}z(r),Z(n[r-1].taskFriendly)}},Y=e=>{var n,t,o;(null===(n=j.current)||void 0===n?void 0:n.clientHeight)!==void 0&&(e.y+(null===(t=j.current)||void 0===t?void 0:t.clientHeight)===(null===(o=j.current)||void 0===o?void 0:o.scrollHeight)?y(!0):y(!1))},V=()=>{var e,n;null===(e=j.current)||void 0===e||e.scrollTo({top:null===(n=j.current)||void 0===n?void 0:n.scrollHeight,behavior:"smooth"})};return(0,S.useEffect)(()=>{v&&V()}),(0,S.useEffect)(()=>{T(W())},[O,R,t]),(0,o.jsxs)(r.K,{ml:m?"xl":"lg",mr:m?40:35,mt:"xl",spacing:"xs",sx:()=>({height:"calc(100vh - 275px)",display:"flex"}),children:[(0,o.jsx)(w,{modalOpen:L,setModalOpen:M,npGuid:g}),(0,o.jsx)(I,{modalOpen:A,setModalOpen:H,npGuid:g}),(0,o.jsx)(P,{modalOpen:D,setModalOpen:N,npGuid:g}),(0,o.jsx)(F,{modalOpen:K,setModalOpen:U,npGuid:g}),(0,o.jsx)(l.Z,{m:0,p:0,grow:!0,sx:e=>({fontSize:"14px",width:"100%",flex:"1",border:"1px solid",borderColor:e.colors.gray[4],borderRadius:"4px",minHeight:0}),children:(0,o.jsx)(i.x,{viewportRef:j,onScrollPositionChange:Y,sx:e=>({fontSize:m?"14px":"12px",padding:m?"14px":"6px",whiteSpace:"pre-wrap",fontFamily:"monospace",color:e.colors.gray[8],backgroundColor:e.colors.gray[0],height:"100%"}),children:t?(0,s.Ex)(t):"Loading..."})}),(0,o.jsxs)(l.Z,{hidden:!n,sx:()=>({flex:"0"}),children:[(0,o.jsx)(c.F,{data:E,disabled:x,icon:(0,o.jsx)(u.fF,{size:14}),onChange:Z,onDropdownClose:()=>k(!1),onDropdownOpen:()=>k(!0),placeholder:x?"Nimplant is not active":"Type command here...",ref:C,switchDirectionOnFlip:!0,value:O,onKeyDown:(0,p.yr)([["Enter",X],["ArrowUp",()=>_(-1)],["ArrowDown",()=>_(1)]]),sx:()=>({flex:"1"})}),(0,o.jsx)(a.z,{disabled:x,onClick:X,children:"Run command"})]})]})}},3986:function(e,n,t){var o=t(5893),r=t(2623),l=t(7564),i=t(1232);n.Z=function(e){let{icon:n,content:t}=e;return(0,o.jsx)(r.X,{color:"blue",shadow:"sm",p:"md",withBorder:!0,sx:{height:"100%"},children:(0,o.jsxs)(l.K,{pl:5,align:"flex-start",justify:"space-evenly",spacing:"lg",sx:{height:"100%"},children:[(0,o.jsx)(i.Z,{sx:e=>({color:e.colors.gray[3]}),children:n}),(0,o.jsx)(i.Z,{sx:e=>({color:e.colors.gray[7]}),children:t})]})})}},315:function(e,n,t){var o=t(5893),r=t(2623),l=t(1232),i=t(9236);t(7294),n.Z=function(e){let{title:n,icon:t,noBorder:c=!1}=e;return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(r.X,{p:"xl",pl:50,m:-25,mb:c?0:"md",withBorder:!c,sx:e=>({height:"100px",backgroundColor:e.colors.gray[0]}),children:(0,o.jsxs)(l.Z,{children:[t," ",(0,o.jsx)(i.D,{order:1,children:n})]})})})}},4998:function(e,n,t){t.d(n,{Ex:function(){return b},IZ:function(){return d},L6:function(){return p},QL:function(){return y},S4:function(){return g},TW:function(){return f},VG:function(){return S},XP:function(){return j},Xe:function(){return k},ZS:function(){return T},a6:function(){return v},cT:function(){return C},i$:function(){return E},or:function(){return I},r5:function(){return x},td:function(){return w},uV:function(){return m},yb:function(){return h}});var o,r=t(3575),l=t(5592),i=t(9459),c=t(2647),a=t(9734),o=window.location.origin;let s={commands:"".concat(o,"/api/commands"),downloads:"".concat(o,"/api/downloads"),server:"".concat(o,"/api/server"),serverExit:"".concat(o,"/api/server/exit"),serverConsole:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(o,"/api/server/console/").concat(e,"/").concat(n)},upload:"".concat(o,"/api/upload"),nimplants:"".concat(o,"/api/nimplants"),nimplantInfo:e=>"".concat(o,"/api/nimplants/").concat(e),nimplantExit:e=>"".concat(o,"/api/nimplants/").concat(e,"/exit"),nimplantCommand:e=>"".concat(o,"/api/nimplants/").concat(e,"/command"),nimplantConsole:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return"".concat(o,"/api/nimplants/").concat(e,"/console/").concat(n,"/").concat(t)},nimplantHistory:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return arguments.length>2&&void 0!==arguments[2]&&arguments[2],"".concat(o,"/api/nimplants/").concat(e,"/history/").concat(n)}},u=async function(e,n){for(var t=arguments.length,o=Array(t>2?t-2:0),r=2;r<t;r++)o[r-2]=arguments[r];let l=await fetch(e,n);return l.json()};function d(){let{data:e,error:n}=(0,a.ZP)(s.commands,u);return{commandList:e,commandListLoading:!n&&!e,commandListError:n}}function h(){let{data:e,error:n}=(0,a.ZP)(s.downloads,u,{refreshInterval:5e3});return{downloads:e,downloadsLoading:!n&&!e,downloadsError:n}}function p(){let{data:e,error:n}=(0,a.ZP)(s.server,u);return{serverInfo:e,serverInfoLoading:!n&&!e,serverInfoError:n}}function x(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3,{data:n,error:t}=(0,a.ZP)(s.serverConsole(e),u,{refreshInterval:5e3});return{serverConsole:n,serverConsoleLoading:!t&&!n,serverConsoleError:t}}function g(){let{data:e,error:n}=(0,a.ZP)(s.nimplants,u,{refreshInterval:2500});return{nimplants:e,nimplantsLoading:!n&&!e,nimplantsError:n}}function f(e){let{data:n,error:t}=(0,a.ZP)(s.nimplantInfo(e),u,{refreshInterval:5e3});return{nimplantInfo:n,nimplantInfoLoading:!t&&!n,nimplantInfoError:t}}function m(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,{data:t,error:o}=(0,a.ZP)(s.nimplantConsole(e,n),u,{refreshInterval:1e3});return{nimplantConsole:t,nimplantConsoleLoading:!o&&!t,nimplantConsoleError:o}}function j(){fetch(s.serverExit,{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{(0,r.c0)({title:"OK",message:"Server is shutting down",color:"green"})}).catch(()=>{(0,r.c0)({title:"Error",message:"Error shutting down server",color:"red"})})}function v(e){fetch(s.nimplantExit(e),{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{(0,r.c0)({title:"OK",message:"Killing Nimplant",color:"green"})}).catch(()=>{(0,r.c0)({title:"Error",message:"Error killing Nimplant",color:"red"})})}function y(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};fetch(s.nimplantCommand(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:n})}).then(e=>{e.ok?((0,r.c0)({title:"OK",message:"Command '"+n.split(" ")[0]+"' submitted",color:"green"}),t()):(0,r.c0)({title:"Error",message:"Error sending command",color:"red"})})}function C(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};if(e.size>5242880&&!confirm("The selected file is larger than 5MB, which may cause unpredictable behavior.\nAre you sure you want to continue?")){t();return}let o=new FormData;o.append("file",e),o.append("filename",e.name),fetch(s.upload,{method:"POST",body:o}).then(e=>{e.json().then(t=>{e.ok?((0,r.c0)({title:"OK",message:"File uploaded to server",color:"green"}),n(t.path)):(0,r.c0)({title:"Error",message:"Error uploading file",color:"red"})})})}function S(e){let n=(0,c.Z)(e,"dd/MM/yyyy HH:mm:ss",new Date);return(0,i.Z)(n,{includeSeconds:!0,addSuffix:!0})}function w(e){if(0===e)return"0 B";let n=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,n)).toFixed(1))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}function E(e){return(0,l.Z)(new Date(1e3*e),"yyyy/MM/dd HH:mm:ss")}function T(e){let n=e.config.listenerHost?e.config.listenerHost:e.config.listenerIp;var t=":".concat(e.config.listenerPort);return("HTTP"===e.config.listenerType&&80===e.config.listenerPort||"HTTPS"===e.config.listenerType&&443===e.config.listenerPort)&&(t=""),"".concat(e.config.listenerType.toLowerCase(),"://").concat(n).concat(t)}function b(e){for(var n="",t=0;t<e.length;t++)e[t].task&&(n+="[".concat(e[t].taskTime,"] > ").concat(e[t].taskFriendly,"\n")),n+="[".concat(e[t].resultTime,"]   ").concat(e[t].result,"\n");return n}function I(){(0,r.c0)({id:"ConnErr",disallowClose:!0,autoClose:!1,title:"Connection error",message:"Trying to reconnect to Nimplant API server",color:"red",loading:!0})}function k(){(0,r.wD)({id:"ConnErr",color:"teal",title:"Connection restored",message:"Connection to the Nimplant API server was restored",autoClose:3e3})}}}]);