"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[200],{3680:function(e,n,t){t.d(n,{Z:function(){return P}});var r=t(5893),o=t(7564),l=t(1232),i=t(3723),a=t(5606),c=t(7841),s=t(5154),u=t(4998),d=t(4065),h=t(5909),p=t(4707),x=t(7294),f=t(3485),g=t(5117),m=t(8818),v=t(50),j=t(8054),y=t(4151),C=t(292),S=t(4201),w=function(e){let{modalOpen:n,setModalOpen:t,npGuid:i}=e,[a,d]=(0,x.useState)(null),[h,p]=(0,x.useState)("go"),[w,E]=(0,x.useState)([]),[T,b]=(0,x.useState)(!1),I=()=>{E([...w,{value:"",type:"z"}])},k=(e,n,t)=>{E(w.map((r,o)=>o===e?{value:n,type:t}:r))},P=e=>{E(w.filter((n,t)=>t!==e))},F=()=>{let e=new FileReader;e.readAsDataURL(a),e.onload=e=>{var t;let r=null===(t=e.target)||void 0===t?void 0:t.result,o=r.replace("data:","").replace(/^.+,/,""),l=w.map(e=>"".concat(e.value," ").concat(e.type)).join(" ");b(!0),(0,u.QL)(String(i),"inline-execute ".concat(o," ").concat(h," ").concat(l),n)};let n=()=>{t(!1),d(null),p("go"),E([]),b(!1)}};return(0,r.jsxs)(f.u,{opened:n,onClose:()=>t(!1),title:(0,r.jsx)("b",{children:"Inline-Execute: Execute BOF file"}),size:"auto",centered:!0,children:[(0,r.jsx)(g.x,{children:"Execute a Beacon Object File (BOF) in-memory."}),(0,r.jsx)(g.x,{children:"Caution: BOF crashes will crash NimPlant too!"}),(0,r.jsx)(m.T,{h:"xl"}),(0,r.jsxs)(v.r,{columns:4,children:[(0,r.jsx)(v.r.Col,{span:3,children:(0,r.jsx)(l.Z,{grow:!0,children:(0,r.jsx)(j.S,{onChange:d,children:e=>(0,r.jsx)(c.z,{color:"gray",...e,children:a?"BOF file: "+a.name:"Select x64 BOF file"})})})}),(0,r.jsx)(v.r.Col,{span:1,children:(0,r.jsx)(y.I,{placeholder:"Entrypoint",value:h,onChange:e=>p(e.currentTarget.value)})})]}),(0,r.jsx)(o.K,{py:w.length>0?"lg":"sm",children:w.map((e,n)=>(0,r.jsxs)(v.r,{columns:12,children:[(0,r.jsx)(v.r.Col,{span:8,children:(0,r.jsx)(y.I,{placeholder:"Argument ".concat(n+1),value:e.value,onChange:t=>k(n,t.currentTarget.value,e.type)})}),(0,r.jsx)(v.r.Col,{span:3,children:(0,r.jsx)(C.p,{placeholder:"Argument type",value:e.type,onChange:t=>k(n,e.value,t.currentTarget.value),data:[{label:"String",value:"z"},{label:"Wide String",value:"Z"},{label:"Integer",value:"i"},{label:"Short",value:"s"},{label:"Binary (b64)",value:"b"}]})}),(0,r.jsx)(v.r.Col,{span:1,children:(0,r.jsx)(S.P,{size:"lg",onClick:()=>P(n)})})]},n))}),(0,r.jsx)(l.Z,{grow:!0,children:(0,r.jsx)(c.z,{color:"gray",onClick:I,children:"Add argument"})}),(0,r.jsx)(m.T,{h:"xl"}),(0,r.jsx)(c.z,{onClick:F,leftIcon:(0,r.jsx)(s.fF,{}),loading:T,sx:{width:"100%"},children:"Execute"})]})},E=t(9814),T=t(9876),b=t(8602),I=function(e){let{modalOpen:n,setModalOpen:t,npGuid:o}=e,[l,i]=(0,x.useState)(null),[a,d]=(0,x.useState)(""),[h,p]=(0,x.useState)(!0),[v,C]=(0,x.useState)(!0),[S,w]=(0,x.useState)(!1),I=()=>{l&&null!==l&&(w(!0),(0,u.cT)(l,k,P))},k=e=>{(0,u.QL)(String(o),"execute-assembly BYPASSAMSI=".concat(h?1:0," BLOCKETW=").concat(v?1:0,' "').concat(e,'" ').concat(a),P)},P=()=>{t(!1),i(null),d(""),p(!0),C(!0),w(!1)};return(0,r.jsxs)(f.u,{opened:n,onClose:()=>t(!1),title:(0,r.jsx)("b",{children:"Execute-Assembly: Execute .NET program"}),size:"auto",centered:!0,children:[(0,r.jsx)(g.x,{children:"Execute a .NET (C#) program in-memory."}),(0,r.jsx)(g.x,{children:"Caution: Running execute-assembly will load the CLR!"}),(0,r.jsx)(m.T,{h:"xl"}),(0,r.jsxs)(E.M,{cols:1,children:[(0,r.jsx)(j.S,{onChange:i,children:e=>(0,r.jsx)(c.z,{color:"gray",...e,children:l?"File: "+l.name:"Select .NET binary"})}),(0,r.jsx)(y.I,{placeholder:"Arguments",value:a,onChange:e=>d(e.currentTarget.value)}),(0,r.jsxs)(T.k,{gap:"xl",justify:"center",align:"center",children:[(0,r.jsx)(b.A,{checked:h,onChange:p,children:"Patch AMSI"}),(0,r.jsx)(b.A,{checked:v,onChange:C,children:"Block ETW"})]})]}),(0,r.jsx)(m.T,{h:"xl"}),(0,r.jsx)(c.z,{onClick:I,leftIcon:(0,r.jsx)(s.fF,{}),sx:{width:"100%"},loading:S,children:"Execute"})]})},k=function(e){let{modalOpen:n,setModalOpen:t,npGuid:o}=e,[l,i]=(0,x.useState)(null),[a,d]=(0,x.useState)(""),[h,p]=(0,x.useState)(!1),v=()=>{l&&null!==l&&(p(!0),(0,u.cT)(l,C,S))},C=e=>{(0,u.QL)(String(o),'upload "'.concat(e,'" "').concat(a,'"'),S)},S=()=>{t(!1),i(null),d(""),p(!1)};return(0,r.jsxs)(f.u,{opened:n,onClose:()=>t(!1),title:(0,r.jsx)("b",{children:"Upload: Upload a file"}),size:"auto",centered:!0,children:[(0,r.jsx)(g.x,{children:"Upload a file to the target."}),(0,r.jsx)(m.T,{h:"xl"}),(0,r.jsxs)(E.M,{cols:1,children:[(0,r.jsx)(j.S,{onChange:i,children:e=>(0,r.jsx)(c.z,{color:"gray",...e,children:l?"File: "+l.name:"Select file"})}),(0,r.jsx)(y.I,{placeholder:"Destination Path (optional)",value:a,onChange:e=>d(e.currentTarget.value)})]}),(0,r.jsx)(m.T,{h:"xl"}),(0,r.jsx)(c.z,{onClick:v,leftIcon:(0,r.jsx)(s.DUB,{}),sx:{width:"100%"},loading:h,children:"Upload"})]})},P=function(e){let{allowInput:n,consoleData:t,disabled:f,guid:g,inputFunction:m}=e,v=(0,d.a)("(min-width: 800px)"),j=(0,x.useRef)(),[y,C]=(0,x.useState)(!0),S=(0,h.P)(),[E,T]=(0,x.useState)([]),[b,P]=(0,x.useState)(!1),[F,O]=(0,x.useState)(""),[Z,B]=(0,x.useState)(0),[L,z]=(0,x.useState)(!1),[A,M]=(0,x.useState)(!1),[H,D]=(0,x.useState)(!1),{commandList:N,commandListLoading:K,commandListError:R}=(0,u.IZ)(),U=()=>{if(""===F)return[];var e=[];return K||R||(e=N.map(e=>e.command)),Object.keys(t).forEach(n=>{if(null!==t[n].taskFriendly){var r=t[n].taskFriendly;e.includes(r)||e.push(r)}}),e.filter(e=>e.startsWith(F)&&e!=F)},G=()=>{if(void 0!==m&&void 0!==g){if(0===E.length)P(!1);else if(b)return;"inline-execute"===F?z(!0):"execute-assembly"===F?M(!0):"upload"===F?D(!0):m(g,F),B(0),O("")}},W=e=>{let n=t.filter(e=>null!==e.taskFriendly),r=n.length;var o=Z+e;if(0!==r&&(n.some(e=>e.taskFriendly==F)||""===F)&&(0!==Z||1!==e)){if(0===Z&&-1===e&&(o=r),o<1)o=1;else if(o>r){B(0),O("");return}B(o),O(n[o-1].taskFriendly)}},Q=e=>{var n,t,r;(null===(n=j.current)||void 0===n?void 0:n.clientHeight)!==void 0&&(e.y+(null===(t=j.current)||void 0===t?void 0:t.clientHeight)===(null===(r=j.current)||void 0===r?void 0:r.scrollHeight)?C(!0):C(!1))},X=()=>{var e,n;null===(e=j.current)||void 0===e||e.scrollTo({top:null===(n=j.current)||void 0===n?void 0:n.scrollHeight,behavior:"smooth"})};return(0,x.useEffect)(()=>{y&&X()}),(0,x.useEffect)(()=>{T(U())},[F,K,t]),(0,r.jsxs)(o.K,{ml:v?"xl":"lg",mr:v?40:35,mt:"xl",spacing:"xs",sx:()=>({height:"calc(100vh - 275px)",display:"flex"}),children:[(0,r.jsx)(w,{modalOpen:L,setModalOpen:z,npGuid:g}),(0,r.jsx)(I,{modalOpen:A,setModalOpen:M,npGuid:g}),(0,r.jsx)(k,{modalOpen:H,setModalOpen:D,npGuid:g}),(0,r.jsx)(l.Z,{m:0,p:0,grow:!0,sx:e=>({fontSize:"14px",width:"100%",flex:"1",border:"1px solid",borderColor:e.colors.gray[4],borderRadius:"4px",minHeight:0}),children:(0,r.jsx)(i.x,{viewportRef:j,onScrollPositionChange:Q,sx:e=>({fontSize:v?"14px":"12px",padding:v?"14px":"6px",whiteSpace:"pre-wrap",fontFamily:"monospace",color:e.colors.gray[8],backgroundColor:e.colors.gray[0],height:"100%"}),children:t?(0,u.Ex)(t):"Loading..."})}),(0,r.jsxs)(l.Z,{hidden:!n,sx:()=>({flex:"0"}),children:[(0,r.jsx)(a.F,{data:E,disabled:f,icon:(0,r.jsx)(s.fF,{size:14}),onChange:O,onDropdownClose:()=>P(!1),onDropdownOpen:()=>P(!0),placeholder:f?"Nimplant is not active":"Type command here...",ref:S,switchDirectionOnFlip:!0,value:F,onKeyDown:(0,p.yr)([["Enter",G],["ArrowUp",()=>W(-1)],["ArrowDown",()=>W(1)]]),sx:()=>({flex:"1"})}),(0,r.jsx)(c.z,{disabled:f,onClick:G,children:"Run command"})]})]})}},3986:function(e,n,t){var r=t(5893),o=t(2623),l=t(7564),i=t(1232);n.Z=function(e){let{icon:n,content:t}=e;return(0,r.jsx)(o.X,{color:"blue",shadow:"sm",p:"md",withBorder:!0,sx:{height:"100%"},children:(0,r.jsxs)(l.K,{pl:5,align:"flex-start",justify:"space-evenly",spacing:"lg",sx:{height:"100%"},children:[(0,r.jsx)(i.Z,{sx:e=>({color:e.colors.gray[3]}),children:n}),(0,r.jsx)(i.Z,{sx:e=>({color:e.colors.gray[7]}),children:t})]})})}},315:function(e,n,t){var r=t(5893),o=t(2623),l=t(1232),i=t(9236);t(7294),n.Z=function(e){let{title:n,icon:t,noBorder:a=!1}=e;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(o.X,{p:"xl",pl:50,m:-25,mb:a?0:"md",withBorder:!a,sx:e=>({height:"100px",backgroundColor:e.colors.gray[0]}),children:(0,r.jsxs)(l.Z,{children:[t," ",(0,r.jsx)(i.D,{order:1,children:n})]})})})}},4998:function(e,n,t){t.d(n,{Ex:function(){return b},IZ:function(){return d},L6:function(){return p},QL:function(){return y},S4:function(){return f},TW:function(){return g},VG:function(){return S},XP:function(){return v},Xe:function(){return k},ZS:function(){return T},a6:function(){return j},cT:function(){return C},i$:function(){return E},or:function(){return I},r5:function(){return x},td:function(){return w},uV:function(){return m},yb:function(){return h}});var r,o=t(3575),l=t(5592),i=t(9459),a=t(2647),c=t(9734),r=window.location.origin;let s={commands:"".concat(r,"/api/commands"),downloads:"".concat(r,"/api/downloads"),server:"".concat(r,"/api/server"),serverExit:"".concat(r,"/api/server/exit"),serverConsole:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(r,"/api/server/console/").concat(e,"/").concat(n)},upload:"".concat(r,"/api/upload"),nimplants:"".concat(r,"/api/nimplants"),nimplantInfo:e=>"".concat(r,"/api/nimplants/").concat(e),nimplantExit:e=>"".concat(r,"/api/nimplants/").concat(e,"/exit"),nimplantCommand:e=>"".concat(r,"/api/nimplants/").concat(e,"/command"),nimplantConsole:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return"".concat(r,"/api/nimplants/").concat(e,"/console/").concat(n,"/").concat(t)},nimplantHistory:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return arguments.length>2&&void 0!==arguments[2]&&arguments[2],"".concat(r,"/api/nimplants/").concat(e,"/history/").concat(n)}},u=async function(e,n){for(var t=arguments.length,r=Array(t>2?t-2:0),o=2;o<t;o++)r[o-2]=arguments[o];let l=await fetch(e,n);return l.json()};function d(){let{data:e,error:n}=(0,c.ZP)(s.commands,u);return{commandList:e,commandListLoading:!n&&!e,commandListError:n}}function h(){let{data:e,error:n}=(0,c.ZP)(s.downloads,u,{refreshInterval:5e3});return{downloads:e,downloadsLoading:!n&&!e,downloadsError:n}}function p(){let{data:e,error:n}=(0,c.ZP)(s.server,u);return{serverInfo:e,serverInfoLoading:!n&&!e,serverInfoError:n}}function x(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3,{data:n,error:t}=(0,c.ZP)(s.serverConsole(e),u,{refreshInterval:5e3});return{serverConsole:n,serverConsoleLoading:!t&&!n,serverConsoleError:t}}function f(){let{data:e,error:n}=(0,c.ZP)(s.nimplants,u,{refreshInterval:2500});return{nimplants:e,nimplantsLoading:!n&&!e,nimplantsError:n}}function g(e){let{data:n,error:t}=(0,c.ZP)(s.nimplantInfo(e),u,{refreshInterval:5e3});return{nimplantInfo:n,nimplantInfoLoading:!t&&!n,nimplantInfoError:t}}function m(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,{data:t,error:r}=(0,c.ZP)(s.nimplantConsole(e,n),u,{refreshInterval:1e3});return{nimplantConsole:t,nimplantConsoleLoading:!r&&!t,nimplantConsoleError:r}}function v(){fetch(s.serverExit,{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{(0,o.c0)({title:"OK",message:"Server is shutting down",color:"green"})}).catch(()=>{(0,o.c0)({title:"Error",message:"Error shutting down server",color:"red"})})}function j(e){fetch(s.nimplantExit(e),{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{(0,o.c0)({title:"OK",message:"Killing Nimplant",color:"green"})}).catch(()=>{(0,o.c0)({title:"Error",message:"Error killing Nimplant",color:"red"})})}function y(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};fetch(s.nimplantCommand(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:n})}).then(e=>{e.ok?((0,o.c0)({title:"OK",message:"Command '"+n.split(" ")[0]+"' submitted",color:"green"}),t()):(0,o.c0)({title:"Error",message:"Error sending command",color:"red"})})}function C(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};if(e.size>5242880&&!confirm("The selected file is larger than 5MB, which may cause unpredictable behavior.\nAre you sure you want to continue?")){t();return}let r=new FormData;r.append("file",e),r.append("filename",e.name),fetch(s.upload,{method:"POST",body:r}).then(e=>{e.json().then(t=>{e.ok?((0,o.c0)({title:"OK",message:"File uploaded to server",color:"green"}),n(t.path)):(0,o.c0)({title:"Error",message:"Error uploading file",color:"red"})})})}function S(e){let n=(0,a.Z)(e,"dd/MM/yyyy HH:mm:ss",new Date);return(0,i.Z)(n,{includeSeconds:!0,addSuffix:!0})}function w(e){if(0===e)return"0 B";let n=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,n)).toFixed(1))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}function E(e){return(0,l.Z)(new Date(1e3*e),"yyyy/MM/dd HH:mm:ss")}function T(e){let n=e.config.listenerHost?e.config.listenerHost:e.config.listenerIp;var t=":".concat(e.config.listenerPort);return("HTTP"===e.config.listenerType&&80===e.config.listenerPort||"HTTPS"===e.config.listenerType&&443===e.config.listenerPort)&&(t=""),"".concat(e.config.listenerType.toLowerCase(),"://").concat(n).concat(t)}function b(e){for(var n="",t=0;t<e.length;t++)e[t].task&&(n+="[".concat(e[t].taskTime,"] > ").concat(e[t].taskFriendly,"\n")),n+="[".concat(e[t].resultTime,"]   ").concat(e[t].result,"\n");return n}function I(){(0,o.c0)({id:"ConnErr",disallowClose:!0,autoClose:!1,title:"Connection error",message:"Trying to reconnect to Nimplant API server",color:"red",loading:!0})}function k(){(0,o.wD)({id:"ConnErr",color:"teal",title:"Connection restored",message:"Connection to the Nimplant API server was restored",autoClose:3e3})}}}]);