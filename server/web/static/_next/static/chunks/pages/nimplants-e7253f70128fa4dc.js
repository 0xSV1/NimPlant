(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[121],{1017:function(e,n,r){"use strict";r.d(n,{Z:function(){return B}});var t=r(7294),o=r(4761),i=r(8427),l=r(2623);let a=(0,t.createContext)({padding:0}),c=a.Provider,s=()=>(0,t.useContext)(a).padding;var d=r(6817),u=(0,d.k)((e,{padding:n,withBorder:r,inheritPadding:t})=>{let o=e.fn.size({size:n,sizes:e.spacing}),i=-1*o,l="dark"===e.colorScheme?e.colors.dark[4]:e.colors.gray[3];return{cardSection:{display:"block",marginLeft:i,marginRight:i,paddingLeft:t?o:void 0,paddingRight:t?o:void 0,borderTop:r&&`1px solid ${l}`,borderBottom:r&&`1px solid ${l}`,"& + &":{borderTop:0},"&[data-first]":{marginTop:i,borderTop:0,borderBottom:r&&`1px solid ${l}`},"&[data-last]":{marginBottom:i,borderBottom:0}}}}),p=r(4523),f=Object.defineProperty,m=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable,x=(e,n,r)=>n in e?f(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,y=(e,n)=>{for(var r in n||(n={}))h.call(n,r)&&x(e,r,n[r]);if(m)for(var r of m(n))g.call(n,r)&&x(e,r,n[r]);return e},j=(e,n)=>{var r={};for(var t in e)h.call(e,t)&&0>n.indexOf(t)&&(r[t]=e[t]);if(null!=e&&m)for(var t of m(e))0>n.indexOf(t)&&g.call(e,t)&&(r[t]=e[t]);return r};let v={withBorder:!1,inheritPadding:!1},w=(0,t.forwardRef)((e,n)=>{let r=(0,o.N4)("CardSection",v,e),{className:i,withBorder:l,inheritPadding:a,unstyled:c}=r,d=j(r,["className","withBorder","inheritPadding","unstyled"]),{classes:f,cx:m}=u({padding:s(),withBorder:l,inheritPadding:a},{name:"Card",unstyled:c});return t.createElement(p.x,y({className:m(f.cardSection,i),ref:n},d))});w.displayName="@mantine/core/CardSection";let b=(0,i.F)(w);var C=(0,d.k)(e=>({root:{position:"relative",overflow:"hidden",backgroundColor:"dark"===e.colorScheme?e.colors.dark[6]:e.white}})),E=Object.defineProperty,O=Object.getOwnPropertySymbols,Z=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable,T=(e,n,r)=>n in e?E(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,S=(e,n)=>{for(var r in n||(n={}))Z.call(n,r)&&T(e,r,n[r]);if(O)for(var r of O(n))P.call(n,r)&&T(e,r,n[r]);return e},N=(e,n)=>{var r={};for(var t in e)Z.call(e,t)&&0>n.indexOf(t)&&(r[t]=e[t]);if(null!=e&&O)for(var t of O(e))0>n.indexOf(t)&&P.call(e,t)&&(r[t]=e[t]);return r};let k={p:"md"},I=(0,t.forwardRef)((e,n)=>{let r=(0,o.N4)("Card",k,e),{className:i,p:a,radius:s,children:d,unstyled:u}=r,p=N(r,["className","p","radius","children","unstyled"]),{classes:f,cx:m}=C(null,{name:"Card",unstyled:u}),h=t.Children.toArray(d),g=h.map((e,n)=>"object"==typeof e&&e&&"type"in e&&e.type===b?(0,t.cloneElement)(e,{padding:a,"data-first":0===n||void 0,"data-last":n===h.length-1||void 0}):e);return t.createElement(c,{value:{padding:a}},t.createElement(l.X,S({className:m(f.root,i),radius:s,p:a,ref:n},p),g))});I.Section=b,I.displayName="@mantine/core/Card";let B=(0,i.F)(I)},7564:function(e,n,r){"use strict";r.d(n,{K:function(){return h}});var t=r(7294),o=r(4761),i=(0,r(6817).k)((e,{spacing:n,align:r,justify:t})=>({root:{display:"flex",flexDirection:"column",alignItems:r,justifyContent:t,gap:e.fn.size({size:n,sizes:e.spacing})}})),l=r(4523),a=Object.defineProperty,c=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,u=(e,n,r)=>n in e?a(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,p=(e,n)=>{for(var r in n||(n={}))s.call(n,r)&&u(e,r,n[r]);if(c)for(var r of c(n))d.call(n,r)&&u(e,r,n[r]);return e},f=(e,n)=>{var r={};for(var t in e)s.call(e,t)&&0>n.indexOf(t)&&(r[t]=e[t]);if(null!=e&&c)for(var t of c(e))0>n.indexOf(t)&&d.call(e,t)&&(r[t]=e[t]);return r};let m={spacing:"md",align:"stretch",justify:"flex-start"},h=(0,t.forwardRef)((e,n)=>{let r=(0,o.N4)("Stack",m,e),{spacing:a,className:c,align:s,justify:d,unstyled:u}=r,h=f(r,["spacing","className","align","justify","unstyled"]),{classes:g,cx:x}=i({spacing:a,align:s,justify:d},{name:"Stack",unstyled:u});return t.createElement(l.x,p({className:x(g.root,c),ref:n},h))});h.displayName="@mantine/core/Stack"},5801:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/nimplants",function(){return r(5844)}])},315:function(e,n,r){"use strict";var t=r(5893),o=r(2623),i=r(1232),l=r(9236);r(7294),n.Z=function(e){let{title:n,icon:r,noBorder:a=!1}=e;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(o.X,{p:"xl",pl:50,m:-25,mb:a?0:"md",withBorder:!a,sx:e=>({height:"100px",backgroundColor:e.colors.gray[0]}),children:(0,t.jsxs)(i.Z,{children:[r," ",(0,t.jsx)(l.D,{order:1,children:n})]})})})}},4998:function(e,n,r){"use strict";r.d(n,{Ex:function(){return Z},IZ:function(){return u},L6:function(){return f},QL:function(){return v},S4:function(){return h},TW:function(){return g},VG:function(){return b},XP:function(){return y},Xe:function(){return T},ZS:function(){return O},a6:function(){return j},cT:function(){return w},i$:function(){return E},or:function(){return P},r5:function(){return m},td:function(){return C},uV:function(){return x},yb:function(){return p}});var t,o=r(3575),i=r(5592),l=r(9459),a=r(2647),c=r(9734),t=window.location.origin;let s={commands:"".concat(t,"/api/commands"),downloads:"".concat(t,"/api/downloads"),server:"".concat(t,"/api/server"),serverExit:"".concat(t,"/api/server/exit"),serverConsole:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(t,"/api/server/console/").concat(e,"/").concat(n)},upload:"".concat(t,"/api/upload"),nimplants:"".concat(t,"/api/nimplants"),nimplantInfo:e=>"".concat(t,"/api/nimplants/").concat(e),nimplantExit:e=>"".concat(t,"/api/nimplants/").concat(e,"/exit"),nimplantCommand:e=>"".concat(t,"/api/nimplants/").concat(e,"/command"),nimplantConsole:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return"".concat(t,"/api/nimplants/").concat(e,"/console/").concat(n,"/").concat(r)},nimplantHistory:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return arguments.length>2&&void 0!==arguments[2]&&arguments[2],"".concat(t,"/api/nimplants/").concat(e,"/history/").concat(n)}},d=async function(e,n){for(var r=arguments.length,t=Array(r>2?r-2:0),o=2;o<r;o++)t[o-2]=arguments[o];let i=await fetch(e,n);return i.json()};function u(){let{data:e,error:n}=(0,c.ZP)(s.commands,d);return{commandList:e,commandListLoading:!n&&!e,commandListError:n}}function p(){let{data:e,error:n}=(0,c.ZP)(s.downloads,d,{refreshInterval:5e3});return{downloads:e,downloadsLoading:!n&&!e,downloadsError:n}}function f(){let{data:e,error:n}=(0,c.ZP)(s.server,d);return{serverInfo:e,serverInfoLoading:!n&&!e,serverInfoError:n}}function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3,{data:n,error:r}=(0,c.ZP)(s.serverConsole(e),d,{refreshInterval:5e3});return{serverConsole:n,serverConsoleLoading:!r&&!n,serverConsoleError:r}}function h(){let{data:e,error:n}=(0,c.ZP)(s.nimplants,d,{refreshInterval:2500});return{nimplants:e,nimplantsLoading:!n&&!e,nimplantsError:n}}function g(e){let{data:n,error:r}=(0,c.ZP)(s.nimplantInfo(e),d,{refreshInterval:5e3});return{nimplantInfo:n,nimplantInfoLoading:!r&&!n,nimplantInfoError:r}}function x(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,{data:r,error:t}=(0,c.ZP)(s.nimplantConsole(e,n),d,{refreshInterval:1e3});return{nimplantConsole:r,nimplantConsoleLoading:!t&&!r,nimplantConsoleError:t}}function y(){fetch(s.serverExit,{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{(0,o.c0)({title:"OK",message:"Server is shutting down",color:"green"})}).catch(()=>{(0,o.c0)({title:"Error",message:"Error shutting down server",color:"red"})})}function j(e){fetch(s.nimplantExit(e),{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{(0,o.c0)({title:"OK",message:"Killing Nimplant",color:"green"})}).catch(()=>{(0,o.c0)({title:"Error",message:"Error killing Nimplant",color:"red"})})}function v(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};fetch(s.nimplantCommand(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:n})}).then(e=>{e.ok?((0,o.c0)({title:"OK",message:"Command '"+n.split(" ")[0]+"' submitted",color:"green"}),r()):(0,o.c0)({title:"Error",message:"Error sending command",color:"red"})})}function w(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};if(e.size>5242880&&!confirm("The selected file is larger than 5MB, which may cause unpredictable behavior.\nAre you sure you want to continue?")){r();return}let t=new FormData;t.append("file",e),t.append("filename",e.name),fetch(s.upload,{method:"POST",body:t}).then(e=>{e.json().then(r=>{e.ok?((0,o.c0)({title:"OK",message:"File uploaded to server",color:"green"}),n(r.path)):(0,o.c0)({title:"Error",message:"Error uploading file",color:"red"})})})}function b(e){let n=(0,a.Z)(e,"dd/MM/yyyy HH:mm:ss",new Date);return(0,l.Z)(n,{includeSeconds:!0,addSuffix:!0})}function C(e){if(0===e)return"0 B";let n=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,n)).toFixed(1))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}function E(e){return(0,i.Z)(new Date(1e3*e),"yyyy/MM/dd HH:mm:ss")}function O(e){let n=e.config.listenerHost?e.config.listenerHost:e.config.listenerIp;var r=":".concat(e.config.listenerPort);return("HTTP"===e.config.listenerType&&80===e.config.listenerPort||"HTTPS"===e.config.listenerType&&443===e.config.listenerPort)&&(r=""),"".concat(e.config.listenerType.toLowerCase(),"://").concat(n).concat(r)}function Z(e){for(var n="",r=0;r<e.length;r++)e[r].task&&(n+="[".concat(e[r].taskTime,"] > ").concat(e[r].taskFriendly,"\n")),n+="[".concat(e[r].resultTime,"]   ").concat(e[r].result,"\n");return n}function P(){(0,o.c0)({id:"ConnErr",disallowClose:!0,autoClose:!1,title:"Connection error",message:"Trying to reconnect to Nimplant API server",color:"red",loading:!0})}function T(){(0,o.wD)({id:"ConnErr",color:"teal",title:"Connection restored",message:"Connection to the Nimplant API server was restored",autoClose:3e3})}},5844:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return w}});var t=r(5893),o=r(5154),i=r(3723),l=r(1232),a=r(5117),c=r(1017),s=r(4065),d=r(315),u=r(4998),p=r(966),f=r(7564),m=r(8818),h=r(1664),g=r.n(h),x=r(7294),y=function(e){let{np:n,largeScreen:r}=e;return(0,t.jsx)(l.Z,{grow:!0,py:20,pl:r?50:0,sx:e=>({"&:not(:last-child)":{borderBottom:"1px solid ".concat(e.colors.gray[1])},"&:hover":{cursor:"pointer"}}),children:(0,t.jsx)(g(),{href:"/nimplants/details?guid=".concat(n.guid),passHref:!0,style:{textDecoration:"none"},children:(0,t.jsxs)(l.Z,{sx:e=>({color:e.colors.gray[7]}),grow:!0,children:[(0,t.jsxs)(l.Z,{children:[(0,t.jsx)(l.Z,{ml:r?-50:0,hidden:!r&&!1,sx:e=>n.late?{color:e.colors.orange[3]}:n.active?{color:e.colors.green[3]}:{color:e.colors.rose[3]},children:n.active&&!n.late?(0,t.jsx)(o.gjK,{size:"1.5em"}):(0,t.jsx)(o.J8O,{size:"1.5em"})}),(0,t.jsxs)(f.K,{spacing:0,align:"flex-start",children:[(0,t.jsx)(a.x,{weight:"bold",pl:r?10:0,sx:e=>({color:e.colors.rose[6]}),children:r?"".concat(n.id," - ").concat(n.guid):n.guid}),(0,t.jsxs)(l.Z,{pl:r?10:0,sx:e=>({color:e.colors.gray[5]}),children:[(0,t.jsx)(l.Z,{hidden:!r,children:(0,t.jsx)(o.qyc,{})}),(0,t.jsx)(a.x,{ml:r?-10:0,children:(0,u.VG)(n.lastCheckin)})]})]})]}),(0,t.jsx)(l.Z,{pl:r?10:0,children:(0,t.jsxs)(f.K,{spacing:0,align:"flex-start",children:[(0,t.jsxs)(a.x,{children:[n.username," @ ",n.hostname]}),(0,t.jsxs)(l.Z,{sx:e=>({color:e.colors.gray[5]}),children:[(0,t.jsx)(l.Z,{hidden:!r,children:(0,t.jsx)(o.WIW,{})}),(0,t.jsxs)(a.x,{ml:r?-10:0,children:[n.pname," (",n.pid,")"]})]})]})}),(0,t.jsxs)(l.Z,{pl:r?15:5,children:[(0,t.jsxs)(f.K,{spacing:0,align:"flex-start",children:[(0,t.jsxs)(l.Z,{children:[(0,t.jsx)(l.Z,{hidden:!r,children:(0,t.jsx)(o.AEx,{})}),(0,t.jsx)(a.x,{ml:r?-10:0,children:n.ipAddrInt})]}),(0,t.jsxs)(l.Z,{sx:e=>({color:e.colors.gray[5]}),children:[(0,t.jsx)(l.Z,{hidden:!r,children:(0,t.jsx)(o.H_w,{})}),(0,t.jsx)(a.x,{ml:r?-10:0,children:n.ipAddrExt})]})]}),(0,t.jsxs)(l.Z,{hidden:!r,m:0,p:0,sx:e=>({color:e.colors.gray[5],position:"absolute",float:"right",right:"50px"}),children:[(0,t.jsx)(m.T,{}),(0,t.jsx)(o.H_v,{size:"1.5em"})]})]})]})})})},j=function(){let e=(0,s.a)("(min-width: 800px)"),{nimplants:n,nimplantsLoading:r,nimplantsError:i}=(0,u.S4)();return((0,x.useEffect)(()=>{i?(0,u.or)():n&&(0,u.Xe)()}),r||i)?(0,t.jsxs)(l.Z,{py:"xl",sx:e=>({color:e.colors.gray[5]}),children:[(0,t.jsx)(p.a,{variant:"dots"}),(0,t.jsx)(a.x,{size:"md",children:"Loading..."})]}):0===n.length?(0,t.jsxs)(l.Z,{py:"xl",sx:e=>({color:e.colors.gray[5]}),children:[(0,t.jsx)(o.UMU,{size:"1.5em"}),(0,t.jsx)(a.x,{size:"md",children:"Nothing here..."})]}):n.map(n=>(0,t.jsx)(y,{np:n,largeScreen:e},n.guid))};let v=()=>{let e=(0,s.a)("(min-width: 800px)");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Z,{title:"Nimplants",icon:(0,t.jsx)(o.bHw,{size:"2em"})}),(0,t.jsxs)(i.x,{ml:e?"sm":0,mr:e?"lg":"sm",mt:"xl",children:[(0,t.jsxs)(l.Z,{pl:e?75:10,mb:"lg",grow:!0,sx:e=>({color:e.colors.gray[5]}),children:[(0,t.jsx)(a.x,{size:"lg",children:"Nimplant"}),(0,t.jsx)(a.x,{size:"lg",children:"System"}),(0,t.jsx)(a.x,{size:"lg",children:"Network"})]}),(0,t.jsx)(c.Z,{withBorder:!0,radius:"md",py:0,px:e?"xl":"sm",children:(0,t.jsx)(j,{})})]})]})};var w=v}},function(e){e.O(0,[968,673,774,888,179],function(){return e(e.s=5801)}),_N_E=e.O()}]);