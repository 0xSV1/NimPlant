(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[526],{1017:function(n,e,r){"use strict";r.d(e,{Z:function(){return N}});var t=r(7294),o=r(4761),i=r(8427),a=r(2623);let l=(0,t.createContext)({padding:0}),c=l.Provider,s=()=>(0,t.useContext)(l).padding;var d=r(6817),u=(0,d.k)((n,{padding:e,withBorder:r,inheritPadding:t})=>{let o=n.fn.size({size:e,sizes:n.spacing}),i=-1*o,a="dark"===n.colorScheme?n.colors.dark[4]:n.colors.gray[3];return{cardSection:{display:"block",marginLeft:i,marginRight:i,paddingLeft:t?o:void 0,paddingRight:t?o:void 0,borderTop:r&&`1px solid ${a}`,borderBottom:r&&`1px solid ${a}`,"& + &":{borderTop:0},"&[data-first]":{marginTop:i,borderTop:0,borderBottom:r&&`1px solid ${a}`},"&[data-last]":{marginBottom:i,borderBottom:0}}}}),m=r(4523),f=Object.defineProperty,p=Object.getOwnPropertySymbols,g=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable,v=(n,e,r)=>e in n?f(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,x=(n,e)=>{for(var r in e||(e={}))g.call(e,r)&&v(n,r,e[r]);if(p)for(var r of p(e))h.call(e,r)&&v(n,r,e[r]);return n},y=(n,e)=>{var r={};for(var t in n)g.call(n,t)&&0>e.indexOf(t)&&(r[t]=n[t]);if(null!=n&&p)for(var t of p(n))0>e.indexOf(t)&&h.call(n,t)&&(r[t]=n[t]);return r};let w={withBorder:!1,inheritPadding:!1},b=(0,t.forwardRef)((n,e)=>{let r=(0,o.N4)("CardSection",w,n),{className:i,withBorder:a,inheritPadding:l,unstyled:c}=r,d=y(r,["className","withBorder","inheritPadding","unstyled"]),{classes:f,cx:p}=u({padding:s(),withBorder:a,inheritPadding:l},{name:"Card",unstyled:c});return t.createElement(m.x,x({className:p(f.cardSection,i),ref:e},d))});b.displayName="@mantine/core/CardSection";let j=(0,i.F)(b);var C=(0,d.k)(n=>({root:{position:"relative",overflow:"hidden",backgroundColor:"dark"===n.colorScheme?n.colors.dark[6]:n.white}})),E=Object.defineProperty,P=Object.getOwnPropertySymbols,O=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable,B=(n,e,r)=>e in n?E(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,Z=(n,e)=>{for(var r in e||(e={}))O.call(e,r)&&B(n,r,e[r]);if(P)for(var r of P(e))T.call(e,r)&&B(n,r,e[r]);return n},S=(n,e)=>{var r={};for(var t in n)O.call(n,t)&&0>e.indexOf(t)&&(r[t]=n[t]);if(null!=n&&P)for(var t of P(n))0>e.indexOf(t)&&T.call(n,t)&&(r[t]=n[t]);return r};let k={p:"md"},I=(0,t.forwardRef)((n,e)=>{let r=(0,o.N4)("Card",k,n),{className:i,p:l,radius:s,children:d,unstyled:u}=r,m=S(r,["className","p","radius","children","unstyled"]),{classes:f,cx:p}=C(null,{name:"Card",unstyled:u}),g=t.Children.toArray(d),h=g.map((n,e)=>"object"==typeof n&&n&&"type"in n&&n.type===j?(0,t.cloneElement)(n,{padding:l,"data-first":0===e||void 0,"data-last":e===g.length-1||void 0}):n);return t.createElement(c,{value:{padding:l}},t.createElement(a.X,Z({className:p(f.root,i),radius:s,p:l,ref:e},m),h))});I.Section=j,I.displayName="@mantine/core/Card";let N=(0,i.F)(I)},6771:function(n,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/downloads",function(){return r(9898)}])},315:function(n,e,r){"use strict";var t=r(5893),o=r(2623),i=r(1232),a=r(9236);r(7294),e.Z=function(n){let{title:e,icon:r,noBorder:l=!1}=n;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(o.X,{p:"xl",pl:50,m:-25,mb:l?0:"md",withBorder:!l,sx:n=>({height:"100px",backgroundColor:n.colors.gray[0]}),children:(0,t.jsxs)(i.Z,{children:[r," ",(0,t.jsx)(a.D,{order:1,children:e})]})})})}},4998:function(n,e,r){"use strict";r.d(e,{Ex:function(){return O},IZ:function(){return u},L6:function(){return f},QL:function(){return w},S4:function(){return g},TW:function(){return h},VG:function(){return j},XP:function(){return x},Xe:function(){return B},ZS:function(){return P},a6:function(){return y},cT:function(){return b},i$:function(){return E},or:function(){return T},r5:function(){return p},td:function(){return C},uV:function(){return v},yb:function(){return m}});var t,o=r(3575),i=r(5592),a=r(9459),l=r(2647),c=r(9734),t=window.location.origin;let s={commands:"".concat(t,"/api/commands"),downloads:"".concat(t,"/api/downloads"),server:"".concat(t,"/api/server"),serverExit:"".concat(t,"/api/server/exit"),serverConsole:function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(t,"/api/server/console/").concat(n,"/").concat(e)},upload:"".concat(t,"/api/upload"),nimplants:"".concat(t,"/api/nimplants"),nimplantInfo:n=>"".concat(t,"/api/nimplants/").concat(n),nimplantExit:n=>"".concat(t,"/api/nimplants/").concat(n,"/exit"),nimplantCommand:n=>"".concat(t,"/api/nimplants/").concat(n,"/command"),nimplantConsole:function(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return"".concat(t,"/api/nimplants/").concat(n,"/console/").concat(e,"/").concat(r)},nimplantHistory:function(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return arguments.length>2&&void 0!==arguments[2]&&arguments[2],"".concat(t,"/api/nimplants/").concat(n,"/history/").concat(e)}},d=async function(n,e){for(var r=arguments.length,t=Array(r>2?r-2:0),o=2;o<r;o++)t[o-2]=arguments[o];let i=await fetch(n,e);return i.json()};function u(){let{data:n,error:e}=(0,c.ZP)(s.commands,d);return{commandList:n,commandListLoading:!e&&!n,commandListError:e}}function m(){let{data:n,error:e}=(0,c.ZP)(s.downloads,d,{refreshInterval:5e3});return{downloads:n,downloadsLoading:!e&&!n,downloadsError:e}}function f(){let{data:n,error:e}=(0,c.ZP)(s.server,d);return{serverInfo:n,serverInfoLoading:!e&&!n,serverInfoError:e}}function p(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3,{data:e,error:r}=(0,c.ZP)(s.serverConsole(n),d,{refreshInterval:5e3});return{serverConsole:e,serverConsoleLoading:!r&&!e,serverConsoleError:r}}function g(){let{data:n,error:e}=(0,c.ZP)(s.nimplants,d,{refreshInterval:2500});return{nimplants:n,nimplantsLoading:!e&&!n,nimplantsError:e}}function h(n){let{data:e,error:r}=(0,c.ZP)(s.nimplantInfo(n),d,{refreshInterval:5e3});return{nimplantInfo:e,nimplantInfoLoading:!r&&!e,nimplantInfoError:r}}function v(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,{data:r,error:t}=(0,c.ZP)(s.nimplantConsole(n,e),d,{refreshInterval:1e3});return{nimplantConsole:r,nimplantConsoleLoading:!t&&!r,nimplantConsoleError:t}}function x(){fetch(s.serverExit,{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{(0,o.c0)({title:"OK",message:"Server is shutting down",color:"green"})}).catch(()=>{(0,o.c0)({title:"Error",message:"Error shutting down server",color:"red"})})}function y(n){fetch(s.nimplantExit(n),{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{(0,o.c0)({title:"OK",message:"Killing Nimplant",color:"green"})}).catch(()=>{(0,o.c0)({title:"Error",message:"Error killing Nimplant",color:"red"})})}function w(n,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};fetch(s.nimplantCommand(n),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:e})}).then(n=>{n.ok?((0,o.c0)({title:"OK",message:"Command '"+e.split(" ")[0]+"' submitted",color:"green"}),r()):(0,o.c0)({title:"Error",message:"Error sending command",color:"red"})})}function b(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};if(n.size>5242880&&!confirm("The selected file is larger than 5MB, which may cause unpredictable behavior.\nAre you sure you want to continue?")){r();return}let t=new FormData;t.append("file",n),t.append("filename",n.name),fetch(s.upload,{method:"POST",body:t}).then(n=>{n.json().then(r=>{n.ok?((0,o.c0)({title:"OK",message:"File uploaded to server",color:"green"}),e(r.path)):(0,o.c0)({title:"Error",message:"Error uploading file",color:"red"})})})}function j(n){let e=(0,l.Z)(n,"dd/MM/yyyy HH:mm:ss",new Date);return(0,a.Z)(e,{includeSeconds:!0,addSuffix:!0})}function C(n){if(0===n)return"0 B";let e=Math.floor(Math.log(n)/Math.log(1024));return parseFloat((n/Math.pow(1024,e)).toFixed(1))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][e]}function E(n){return(0,i.Z)(new Date(1e3*n),"yyyy/MM/dd HH:mm:ss")}function P(n){let e=n.config.listenerHost?n.config.listenerHost:n.config.listenerIp;var r=":".concat(n.config.listenerPort);return("HTTP"===n.config.listenerType&&80===n.config.listenerPort||"HTTPS"===n.config.listenerType&&443===n.config.listenerPort)&&(r=""),"".concat(n.config.listenerType.toLowerCase(),"://").concat(e).concat(r)}function O(n){for(var e="",r=0;r<n.length;r++)n[r].task&&(e+="[".concat(n[r].taskTime,"] > ").concat(n[r].taskFriendly,"\n")),e+="[".concat(n[r].resultTime,"]   ").concat(n[r].result,"\n");return e}function T(){(0,o.c0)({id:"ConnErr",disallowClose:!0,autoClose:!1,title:"Connection error",message:"Trying to reconnect to Nimplant API server",color:"red",loading:!0})}function B(){(0,o.wD)({id:"ConnErr",color:"teal",title:"Connection restored",message:"Connection to the Nimplant API server was restored",autoClose:3e3})}},9898:function(n,e,r){"use strict";r.r(e),r.d(e,{default:function(){return h}});var t=r(5893),o=r(5154),i=r(3723),a=r(1232),l=r(5117),c=r(1017),s=r(4065),d=r(4998),u=r(1664),m=r.n(u),f=function(){let{downloads:n,downloadsLoading:e,downloadsError:r}=(0,d.yb)();return n&&0!==n.length?(0,t.jsx)(t.Fragment,{children:n.map((n,e)=>(0,t.jsx)(a.Z,{py:"xl",grow:!0,sx:n=>({"&:not(:last-child)":{borderBottom:"1px solid ".concat(n.colors.gray[1])},"&:hover":{cursor:"pointer"}}),children:(0,t.jsx)(m(),{href:"/api/downloads/".concat(n.name),passHref:!0,style:{textDecoration:"none"},children:(0,t.jsxs)(a.Z,{grow:!0,children:[(0,t.jsx)(l.x,{size:"lg",color:"dark",children:n.name}),(0,t.jsx)(l.x,{pl:10,size:"lg",color:"gray",children:(0,d.td)(n.size)}),(0,t.jsx)(l.x,{pl:20,size:"lg",color:"gray",children:(0,d.i$)(n.lastmodified)})]})})},e))}):(0,t.jsxs)(a.Z,{py:"xl",sx:n=>({color:n.colors.gray[5]}),children:[(0,t.jsx)(o.UMU,{size:"1.5em"}),(0,t.jsx)(l.x,{size:"md",children:"Nothing here..."})]})},p=r(315);let g=()=>{let n=(0,s.a)("(min-width: 800px)");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Z,{title:"Downloads",icon:(0,t.jsx)(o.aBF,{size:"2em"}),noBorder:!0}),(0,t.jsxs)(i.x,{ml:n?"sm":0,mr:n?"lg":"sm",mt:"xl",children:[(0,t.jsxs)(a.Z,{pl:n?25:10,mb:"lg",grow:!0,sx:n=>({color:n.colors.gray[5]}),children:[(0,t.jsx)(l.x,{size:"lg",children:"Filename"}),(0,t.jsx)(l.x,{size:"lg",children:"Size"}),(0,t.jsx)(l.x,{size:"lg",children:"Downloaded"})]}),(0,t.jsx)(c.Z,{withBorder:!0,radius:"md",my:"sm",py:0,px:n?"xl":"sm",children:(0,t.jsx)(f,{})})]})]})};var h=g}},function(n){n.O(0,[968,673,774,888,179],function(){return n(n.s=6771)}),_N_E=n.O()}]);